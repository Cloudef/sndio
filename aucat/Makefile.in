# extra includes paths (-I options)
INCLUDE = -I../libsndio -I../bsd-compat

# extra libraries paths (-L options)
LIB = -L../libsndio

# extra defines (-D options)
DEFS = -DDEBUG @defs@

# extra libraries (-l options)
LDADD = -lsndio @ldadd@

# variables defined on configure script command line (if any)
@vars@

#
# binaries, documentation, man pages and examples will be installed in 
# ${BIN_DIR}, ${MAN1_DIR}
#
BIN_DIR = @bindir@
MAN1_DIR = @mandir@/man1

#
# programs to build
#
PROG = aucat midicat
MAN1 = aucat.1 midicat.1

all:		${PROG}

install:
		mkdir -p ${DESTDIR}${BIN_DIR} ${DESTDIR}${MAN1_DIR}
		cp aucat ${DESTDIR}${BIN_DIR}
		cd ${DESTDIR}${BIN_DIR} && ln -f aucat midicat
		cp ${MAN1} ${DESTDIR}${MAN1_DIR}

uninstall:
		cd ${DESTDIR}${BIN_DIR} && rm -f ${PROG}
		cd ${DESTDIR}${MAN1_DIR} && rm -f ${MAN1}

clean:
		rm -f -- ${PROG} *.o *~ *.bak *.tmp *.core core

# ---------------------------------------------------------- dependencies ---

OBJS = \
abuf.o aparams.o aproc.o aucat.o dbg.o dev.o file.o headers.o \
listen.o midi.o miofile.o opt.o pipe.o siofile.o sock.o \
wav.o

aucat:		${OBJS}
		${CC} ${LDFLAGS} ${LIB} -o aucat ${OBJS} ${LDADD} 

midicat:	aucat
		ln -f aucat midicat

.c.o:
		${CC} ${CFLAGS} ${INCLUDE} ${DEFS} -c $<

abuf.o:		abuf.c abuf.h aparams.h aproc.h file.h conf.h dbg.h
aparams.o:	aparams.c aparams.h dbg.h
aproc.o:	aproc.c abuf.h aparams.h aproc.h file.h conf.h midi.h \
		dbg.h
aucat.o:	aucat.c abuf.h aparams.h aproc.h file.h conf.h dev.h \
		listen.h midi.h opt.h wav.h pipe.h dbg.h \
		../bsd-compat/bsd-compat.h
dbg.o:		dbg.c dbg.h
dev.o:		dev.c abuf.h aproc.h aparams.h file.h conf.h dev.h \
		pipe.h miofile.h siofile.h midi.h opt.h dbg.h
file.o:		file.c abuf.h aproc.h aparams.h file.h conf.h dbg.h
headers.o:	headers.c aparams.h conf.h wav.h pipe.h file.h \
		../bsd-compat/bsd-compat.h
legacy.o:	legacy.c wav.h aparams.h pipe.h file.h \
		../bsd-compat/bsd-compat.h
listen.o:	listen.c conf.h listen.h aparams.h file.h sock.h amsg.h \
		pipe.h ../bsd-compat/bsd-compat.h
midi.o:		midi.c abuf.h aproc.h aparams.h file.h conf.h dev.h \
		midi.h dbg.h ../bsd-compat/bsd-compat.h
miofile.o:	miofile.c conf.h file.h miofile.h dbg.h
opt.o:		opt.c conf.h opt.h aparams.h dbg.h
pipe.o:		pipe.c conf.h pipe.h file.h dbg.h
siofile.o:	siofile.c aparams.h aproc.h file.h abuf.h conf.h dev.h \
		siofile.h dbg.h
sock.o:		sock.c abuf.h aproc.h aparams.h file.h conf.h dev.h \
		midi.h opt.h sock.h amsg.h pipe.h dbg.h \
		../bsd-compat/bsd-compat.h
wav.o:		wav.c abuf.h aproc.h aparams.h file.h conf.h dev.h \
		midi.h wav.h pipe.h opt.h dbg.h
